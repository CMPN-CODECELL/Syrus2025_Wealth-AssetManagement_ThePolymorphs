{
  "_id": "8c2c5a83-b2d5-4d85-8cf6-702116ef40e1",
  "aiPersonaId": "a1a54a10-93ea-4e95-b490-2a10a201fde4",
  "integrationId": "ma-wealth-asset-advisor-8549-primary-workflow-for-wealth-asset-advisor",
  "isMiniAgentPrimaryWorkflow": true,
  "name": "Primary Workflow for Wealth & Asset Advisor",
  "publisherAccountId": "f1c8e177-0237-47fb-bf83-ff77ea691f83",
  "startTaskId": "e60b5d0c-4fba-4f4e-ac3a-4c6af890d6f4",
  "status": "Active",
  "tasks": [
    {
      "_id": "e60b5d0c-4fba-4f4e-ac3a-4c6af890d6f4",
      "type": "PassThrough",
      "config": {
        "name": "Pass Through",
        "description": "Pass through the input to the output"
      },
      "transitions": [
        {
          "_id": "60444596-866b-4e59-953e-e6b1586bce7f-e60b5d0c-4fba-4f4e-ac3a-4c6af890d6f4",
          "nextTask": "60444596-866b-4e59-953e-e6b1586bce7f",
          "name": "If query doesnt exists",
          "rules": [
            {
              "type": "any",
              "operator": "notExists",
              "path": "$output.query"
            }
          ]
        },
        {
          "_id": "eb7ae5e5-9290-47d7-802a-5e24766b1628-e60b5d0c-4fba-4f4e-ac3a-4c6af890d6f4",
          "nextTask": "eb7ae5e5-9290-47d7-802a-5e24766b1628",
          "name": "If intents are already classified",
          "rules": [
            {
              "type": "any",
              "operator": "exists",
              "path": "$output.intents"
            },
            {
              "type": "any",
              "operator": "exists",
              "path": "$output.query"
            }
          ]
        },
        {
          "_id": "e60b5d0c-4fba-4f4e-ac3a-4c6af890d6f4-0fe663a4-c6bf-4e67-8e28-34efcd363cb1",
          "name": "If query exists",
          "nextTask": "0fe663a4-c6bf-4e67-8e28-34efcd363cb1",
          "rules": [
            {
              "type": "any",
              "operator": "exists",
              "path": "$output.query"
            },
            {
              "type": "any",
              "operator": "notExists",
              "path": "$output.intents"
            }
          ]
        }
      ],
      "globalVariables": [
        {
          "name": "query",
          "referencePath": "$input.query"
        },
        {
          "name": "rawQuery",
          "referencePath": "$input.rawQuery"
        },
        {
          "name": "conversationId",
          "referencePath": "$input.conversationId"
        }
      ]
    },
    {
      "_id": "60444596-866b-4e59-953e-e6b1586bce7f",
      "type": "Input",
      "config": {
        "name": "User Input",
        "description": "Get user input",
        "type": "string"
      },
      "transitions": [
        {
          "_id": "60444596-866b-4e59-953e-e6b1586bce7f-0fe663a4-c6bf-4e67-8e28-34efcd363cb1",
          "name": "Default",
          "nextTask": "0fe663a4-c6bf-4e67-8e28-34efcd363cb1"
        }
      ],
      "globalVariables": [
        {
          "name": "query",
          "referencePath": "$output.userInput"
        },
        {
          "name": "rawQuery",
          "referencePath": "$output.userInput"
        },
        {
          "name": "selfLoopMiniAgent",
          "referencePath": "true"
        }
      ]
    },
    {
      "_id": "0fe663a4-c6bf-4e67-8e28-34efcd363cb1",
      "type": "Loader",
      "config": {
        "name": "Loader",
        "description": "Display loader message",
        "type": "loader",
        "text": "Just a moment... identifying the best approach to assist you."
      },
      "transitions": [
        {
          "_id": "0fe663a4-c6bf-4e67-8e28-34efcd363cb1-743ede27-9dfc-499b-a557-bd86ef0a0dd3",
          "name": "Default",
          "nextTask": "743ede27-9dfc-499b-a557-bd86ef0a0dd3"
        }
      ]
    },
    {
      "_id": "743ede27-9dfc-499b-a557-bd86ef0a0dd3",
      "type": "IntentClassification",
      "config": {
        "name": "Intent Classification",
        "description": "Classify the intent of the user message",
        "modelId": "8c23a356-420c-4ded-9694-1a571116566b",
        "intents": [
          {
            "name": "Wealth & Asset Management Intent",
            "description": "This intent is dedicated to handling queries that revolve around personalized wealth management and asset analysis. It guides the AI agent to retrieve, analyze, and summarize user-specific financial data (e.g., net worth, asset breakdown, portfolio performance) from your RAG. The flow includes fetching relevant metrics, evaluating asset performance, assessing risk, and suggesting optimization strategies tailored to the user's portfolio.",
            "examples": [
              "“What is my current net worth and how is it distributed among my assets?”",
              "“Can you provide an analysis of my investment portfolio performance over the last year?”",
              "“How are my assets allocated across real estate, stocks, and bonds?”"
            ]
          },
          {
            "name": "General Financial Inquiries Intent",
            "description": "This intent covers a broader range of financial queries that aren’t tied directly to personalized asset management. It is designed to address general financial questions by providing definitions, explanations, market trends, and economic insights. The flow retrieves relevant financial concepts and current market data from your RAG to deliver concise and informative responses.",
            "examples": [
              "“What are the current trends in the global stock market?”",
              "“Explain how inflation impacts consumer savings and investments.”",
              "“What is the effect of rising interest rates on my finances?”"
            ]
          }
        ],
        "query": "$agent.query"
      },
      "transitions": [
        {
          "_id": "743ede27-9dfc-499b-a557-bd86ef0a0dd3-eb7ae5e5-9290-47d7-802a-5e24766b1628",
          "name": "If Intent is Matched",
          "rules": [
            {
              "type": "string",
              "operator": "equal",
              "path": "$output.intentMatched",
              "value": "true"
            }
          ],
          "nextTask": "eb7ae5e5-9290-47d7-802a-5e24766b1628"
        },
        {
          "_id": "743ede27-9dfc-499b-a557-bd86ef0a0dd3-c02000d6-9936-44fe-a24e-96dd455e9c69",
          "name": "If No Intent is Matched",
          "rules": [
            {
              "type": "string",
              "operator": "equal",
              "path": "$output.intentMatched",
              "value": "false"
            }
          ],
          "nextTask": "c02000d6-9936-44fe-a24e-96dd455e9c69"
        }
      ]
    },
    {
      "_id": "eb7ae5e5-9290-47d7-802a-5e24766b1628",
      "type": "JSFunction",
      "config": {
        "name": "JS Function",
        "description": "Execute JS function",
        "code": "\nconst main = () => {\n    const currentExecutionId = _id;\n    const intents = agent?.icIntents?.[currentExecutionId] || input.intents;\n    const currentIndex = agent?.icLoopIndexes?.[currentExecutionId] || 0;\n    const currentIntent = intents[currentIndex] || {};\n    const { intent, task } = currentIntent;\n    const state = currentIndex === intents.length ? 'end' : 'continue'\n    const icLoopIndexes = { ...(agent?.icLoopIndexes || {}), [_id]: state === 'end' ? undefined : currentIndex + 1 };\n    const icIntents = { ...(agent?.icIntents || {}), [_id]: state === 'end' ? undefined : intents };\n    return { ...input, intent, state: currentIndex === intents.length ? 'end' : 'continue', icLoopIndexes, icIntents, query: task };\n};\n\nmain()\n"
      },
      "globalVariables": [
        {
          "referencePath": "$output.icLoopIndexes",
          "name": "icLoopIndexes"
        },
        {
          "referencePath": "$output.icIntents",
          "name": "icIntents"
        }
      ],
      "transitions": [
        {
          "_id": "eb7ae5e5-9290-47d7-802a-5e24766b1628-239ecdb7-1a1e-4ad4-b6ee-38374402b572",
          "name": "If Intent is Matched",
          "rules": [
            {
              "type": "string",
              "operator": "equal",
              "path": "$output.intent",
              "value": "Wealth & Asset Management Intent"
            }
          ],
          "nextTask": "239ecdb7-1a1e-4ad4-b6ee-38374402b572"
        },
        {
          "_id": "eb7ae5e5-9290-47d7-802a-5e24766b1628-135e2933-a970-4a38-ae0b-631a5b4de7c2",
          "name": "If Intent is Matched",
          "rules": [
            {
              "type": "string",
              "operator": "equal",
              "path": "$output.intent",
              "value": "General Financial Inquiries Intent"
            }
          ],
          "nextTask": "135e2933-a970-4a38-ae0b-631a5b4de7c2"
        },
        {
          "_id": "eb7ae5e5-9290-47d7-802a-5e24766b1628-60444596-866b-4e59-953e-e6b1586bce7f",
          "name": "If Self Loop",
          "rules": [
            {
              "type": "string",
              "operator": "equal",
              "path": "$agent.selfLoopMiniAgent",
              "value": "true"
            },
            {
              "type": "string",
              "operator": "equal",
              "path": "$output.state",
              "value": "end"
            }
          ],
          "nextTask": "60444596-866b-4e59-953e-e6b1586bce7f"
        }
      ]
    },
    {
      "_id": "239ecdb7-1a1e-4ad4-b6ee-38374402b572",
      "type": "Workflow",
      "config": {
        "name": "Intent - Wealth & Asset Management Intent",
        "description": "Workflow for intent - Wealth & Asset Management Intent",
        "workflowId": "9d13d26e-1f2a-40da-801b-a0ec5790da53"
      },
      "transitions": [
        {
          "_id": "239ecdb7-1a1e-4ad4-b6ee-38374402b572-eb7ae5e5-9290-47d7-802a-5e24766b1628",
          "name": "Mini agent execution completed",
          "nextTask": "eb7ae5e5-9290-47d7-802a-5e24766b1628"
        }
      ]
    },
    {
      "_id": "135e2933-a970-4a38-ae0b-631a5b4de7c2",
      "type": "Workflow",
      "config": {
        "name": "Intent - General Financial Inquiries Intent",
        "description": "Workflow for intent - General Financial Inquiries Intent",
        "workflowId": "62efda8b-5e6c-4eeb-b8f0-5416ca314ece"
      },
      "transitions": [
        {
          "_id": "135e2933-a970-4a38-ae0b-631a5b4de7c2-eb7ae5e5-9290-47d7-802a-5e24766b1628",
          "name": "Mini agent execution completed",
          "nextTask": "eb7ae5e5-9290-47d7-802a-5e24766b1628"
        }
      ]
    },
    {
      "_id": "c02000d6-9936-44fe-a24e-96dd455e9c69",
      "transitions": [
        {
          "_id": "c02000d6-9936-44fe-a24e-96dd455e9c69-60444596-866b-4e59-953e-e6b1586bce7f",
          "name": "If Self Loop",
          "rules": [
            {
              "type": "string",
              "operator": "equal",
              "path": "$agent.selfLoopMiniAgent",
              "value": "true"
            }
          ],
          "nextTask": "60444596-866b-4e59-953e-e6b1586bce7f"
        }
      ],
      "type": "Output",
      "config": {
        "name": "Output",
        "description": "Output the response to the user",
        "type": "external",
        "text": "Unable to complete task $agent.query"
      }
    },
    {
      "_id": "eff9d69d-f31d-49c3-a5f2-19459904020b",
      "transitions": [
        {
          "_id": "eff9d69d-f31d-49c3-a5f2-19459904020b-60444596-866b-4e59-953e-e6b1586bce7f",
          "name": "If Self Loop",
          "rules": [
            {
              "type": "string",
              "operator": "equal",
              "path": "$agent.selfLoopMiniAgent",
              "value": "true"
            }
          ],
          "nextTask": "60444596-866b-4e59-953e-e6b1586bce7f"
        }
      ],
      "type": "Display",
      "config": {
        "name": "Display",
        "description": "Display the response to the user",
        "type": "text",
        "text": "$input.content"
      }
    }
  ],
  "type": "Conversational",
  "version": "latest"
}